[MySQL]トランザクション分離レベル

# 読み取り不都合

## ダーティリード
別のトランザクションでコミットされてないデータが読み取れる現象。

*    トランザクションAでレコードを①から②にUPDATE（未コミット）
*    トランザクションBでレコードをSELECTする
*    トランザクションAをロールバックする
*    トランザクションBで取得したデータは②となっている。


## ファジーリード（非再現リード,ノンリピータブルリード）

別のトランザクションで更新後データを読むことにより、一貫性がなくなる現象。

*    トランザクションAでレコードをSELECTする。①となっている。
*    トランザクションBでレコードを①から②にUPDATEし、COMMITする。
*    トランザクションAで同じレコードを再度SELECTする。②となっている。


## ファントムリード
別のトランザクションで挿入されたデータが見えることにより、一貫性がなくなる現象。

*    トランザクションAでレコードをSELECTする。該当レコードがない。
*    トランザクションBでレコードをINSERTし、COMMITする。
*    トランザクションAでレコードをSELECTする。2でINSERTとしたレコードが取得できる。


ファジーリードとよく似ているがINSERTとUPDATEという点が違う。
また、以下もファントムリードとなる。

*    トランザクションAでレコードをCOUNTする。X件取得できた。
*    トランザクションBでレコードをINSERTし、COMMITする。
*    トランザクションAでレコードをCOUNTする。X+1件取得できた。

# ロストアップデート
他セッションの更新を、自セッションの更新で上書きしてしまう、後勝ち更新となる。。


## トランザクション分離レベル

|分離レベル       |性能 |ダーティーリード|ファジーリード|ファントムリード|ロストアップデート|
|:---:            |:---:|:--:            |:--:          |:--:            |:--:              |
|read uncommitted |高   |起きる。        |起きる。      |起きる。 	 |起きる。          |
|read committed   | ｜  |起きない。 	 |起きる。      |起きる。 	 |起きる。          |
|repeatable read  | ｜  |起きない。 	 |起きない。    |起きない。 	 |起きる。          |
|serializable     |低   |起きない。 	 |起きない。    |起きない。 	 |起きない。        |


# 外部リンク

* [tree-tips: MySQLのトランザクション分離レベル](http://www.tree-tips.com/mysql/transaction_isoration/)
* [トランザクション分離レベルについて極力分かりやすく解説してみた[SQL] - 明日になったら本気出せる](http://gyouza-daisuki.hatenablog.com/entry/2013/11/19/150838)

